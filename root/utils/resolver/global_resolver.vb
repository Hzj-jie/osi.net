
Option Explicit On
Option Infer Off
Option Strict On

'the following code is generated by /osi/root/codegen/precompile/precompile.exe
'with global_resolver.vbp ----------
'so change global_resolver.vbp instead of this file




'the following code is generated by /osi/root/codegen/precompile/precompile.exe
'with resolver_wrapper.vbp ----------
'so change resolver_wrapper.vbp instead of this file



Imports osi.root.connector
Imports osi.root.formation

Public NotInheritable Class global_resolver
    Public Shared Function resolve(Of T As Class)(ByRef o As T) As Boolean
        Return global_resolver(Of T).resolve(o)
    End Function

    Public Shared Function resolve_or_default(Of T As Class)(ByVal [default] As T) As T
        Return global_resolver(Of T).resolve_or_default([default])
    End Function

    ' global_resolver.register(Of T)(ByVal i As Func(Of T))
    ' cannot work as expected, the compiler automatically infers to
    ' global_resolver.register(Of T As Func(Of ?))(ByVal i As T).

    Private Sub New()
    End Sub
End Class

Public NotInheritable Class global_resolver(Of T As Class)

'the following code is generated by /osi/root/codegen/precompile/precompile.exe
'with global_resolver_impl.vbp ----------
'so change global_resolver_impl.vbp instead of this file


    Private Shared ReadOnly r As thread_safe_resolver(Of T)

    Shared Sub New()
        r = New thread_safe_resolver(Of T)()
    End Sub

'finish global_resolver_impl.vbp --------
    Public Shared Sub register(ByVal i As T)
        r.register(i)
    End Sub

    Public Shared Sub register(ByVal i As Func(Of T))
        r.register(i)
    End Sub

    Public Shared Sub unregister()
        r.unregister()
    End Sub

    Public Shared Function resolve(ByRef o As T) As Boolean
        Return r.resolve(o)
    End Function

    Public Shared Function resolve(Of RT As T)(ByRef r As RT) As Boolean
        Dim o As T = Nothing
        Return resolve(o) AndAlso direct_cast(o, r)
    End Function


'the following code is generated by /osi/root/codegen/precompile/precompile.exe
'with resolver_wrapper_resolve.vbp ----------
'so change resolver_wrapper_resolve.vbp instead of this file



    Public Shared Function resolve(Of RT As T)() As RT
        Dim o As RT = Nothing
        assert(resolve(o))
        Return o
    End Function

    Public Shared Function resolve_or_null(Of RT As T)() As RT
        Dim o As RT = Nothing
        resolve(o)
        Return o
    End Function

    Public Shared Function resolve_or_default(Of RT As T)(Optional ByVal [default] As RT = Nothing) As RT
        Dim o As RT = Nothing
        If resolve(o) Then
            Return o
        Else
            Return [default]
        End If
    End Function

'finish resolver_wrapper_resolve.vbp --------


'the following code is generated by /osi/root/codegen/precompile/precompile.exe
'with resolver_wrapper_resolve.vbp ----------
'so change resolver_wrapper_resolve.vbp instead of this file



    Public Shared Function resolve() As T
        Dim o As T = Nothing
        assert(resolve(o))
        Return o
    End Function

    Public Shared Function resolve_or_null() As T
        Dim o As T = Nothing
        resolve(o)
        Return o
    End Function

    Public Shared Function resolve_or_default(Optional ByVal [default] As T = Nothing) As T
        Dim o As T = Nothing
        If resolve(o) Then
            Return o
        Else
            Return [default]
        End If
    End Function

'finish resolver_wrapper_resolve.vbp --------

    Public Shared Function scoped_register(ByVal i As T) As disposer
        Return scoped_action(Sub()
                                 register(i)
                             End Sub,
                             Sub()
                                 unregister()
                             End Sub)
    End Function

    Public Shared Function scoped_register(ByVal i As Func(Of T)) As disposer
        Return scoped_action(Sub()
                                 register(i)
                             End Sub,
                             Sub()
                                 unregister()
                             End Sub)
    End Function

    Private Sub New()
    End Sub
End Class

'finish resolver_wrapper.vbp --------
'finish global_resolver.vbp --------
