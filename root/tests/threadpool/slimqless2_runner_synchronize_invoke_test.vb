
Option Explicit On
Option Infer Off
Option Strict On

'the following code is generated by /osi/root/codegen/precompile/precompile.exe
'with slimqless2_runner_synchronize_invoke_test.vbp ----------
'so change slimqless2_runner_synchronize_invoke_test.vbp instead of this file


Imports osi.root.connector
Imports osi.root.threadpool
Imports osi.root.utt

Public Class slimqless2_runner_synchronize_invoke_test
    Inherits [case]

    Private Shared Function invoke_asynchronously_case() As Boolean
        Dim t As slimqless2_runner = Nothing
        t = New slimqless2_runner()
        Dim s As slimqless2_runner_synchronize_invoke = Nothing
        s = New slimqless2_runner_synchronize_invoke(t)
        For i As Int32 = 0 To 100
            Dim result As Object = Nothing
            Dim args() As Object = Nothing
            result = New Object()
            ReDim args(2)
            For j As Int32 = 0 To array_size_i(args) - 1
                args(j) = New Object()
            Next
            Dim exec As Func(Of Object, Object, Object, Object) = Nothing
            exec = Function(ByVal a As Object, ByVal b As Object, ByVal c As Object) As Object
                       assertion.reference_equal(a, args(0))
                       assertion.reference_equal(b, args(1))
                       assertion.reference_equal(c, args(2))
                       Return result
                   End Function
            assertion.reference_equal(s.Invoke(exec, args), result)
            Dim ar As IAsyncResult = Nothing
            ar = s.BeginInvoke(exec, args)
            If assertion.is_not_null(ar) Then
                assertion.is_false(ar.CompletedSynchronously())
                assertion.reference_equal(s.EndInvoke(ar), result)
            End If
        Next
        assert(t.stop())
        Return True
    End Function

    Private Shared Function invoke_synchronously_case() As Boolean
        Dim t As slimqless2_runner = Nothing
        t = New slimqless2_runner()
        Dim s As slimqless2_runner_synchronize_invoke = Nothing
        s = New slimqless2_runner_synchronize_invoke(t)
        assert(t.push(Sub()
                          For i As Int32 = 0 To 100
                              Dim result As Object = Nothing
                              Dim args() As Object = Nothing
                              result = New Object()
                              ReDim args(2)
                              For j As Int32 = 0 To array_size_i(args) - 1
                                  args(j) = New Object()
                              Next
                              Dim exec As Func(Of Object, Object, Object, Object) = Nothing
                              exec = Function(ByVal a As Object, ByVal b As Object, ByVal c As Object) As Object
                                         assertion.reference_equal(a, args(0))
                                         assertion.reference_equal(b, args(1))
                                         assertion.reference_equal(c, args(2))
                                         Return result
                                     End Function
                              assertion.reference_equal(s.Invoke(exec, args), result)
                              Dim ar As IAsyncResult = Nothing
                              ar = s.BeginInvoke(exec, args)
                              If assertion.is_not_null(ar) Then
                                  assertion.is_true(ar.CompletedSynchronously())
                                  assertion.reference_equal(s.EndInvoke(ar), result)
                              End If
                          Next
                          assertion.is_true(t.idle())
                          t.stop()
                      End Sub))
        t.join()
        Return True
    End Function

    Public Overrides Function run() As Boolean
        Return invoke_asynchronously_case() AndAlso
               invoke_synchronously_case()
    End Function
End Class
'finish slimqless2_runner_synchronize_invoke_test.vbp --------
