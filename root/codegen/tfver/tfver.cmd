
setlocal

@echo off
call "%~dp0\..\init_vs_env.cmd"
echo.
echo 'this file is generated by /osi/root/codegen/tfver.cmd
echo 'so change the script instead of this file
echo.
echo Public Module _tfver
echo     Public ReadOnly tf_latest_changeset As String = _
set tf_ver=""
set tf_cur_ver=""
REM this script will be called by run.cmd from osi/root/codegen
if defined NO_TFVER (
    set tf_ver=""
) else (
	for /F "delims=" %%i in ('tf history ..\..\ /r /noprompt /stopafter:1 /version:T ^| findstr /v /i "changeset ---------"') do (
		set tf_ver="%%i" )
)
echo          %tf_ver%.Trim()
echo     Public ReadOnly tf_current_changeset As String = _
if defined NO_TFVER (
	set tf_cur_ver=""
) else (
	for /F "delims=" %%i in ('tf history ..\..\ /r /noprompt /stopafter:1 /version:W ^| findstr /v /i "changeset ---------"') do (
		set tf_cur_ver="%%i" )
)
echo          %tf_cur_ver%.Trim()
echo End Module

endlocal
